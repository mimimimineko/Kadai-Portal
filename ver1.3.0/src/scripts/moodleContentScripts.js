//即時対応用
document.documentElement.style.setProperty('--color_primary',  localStorage.getItem('mainColorbyKadaiPortal'));


//読み込みが完了したら実行（読み込みに時間がかかった時用）
window.onload=function(){
  document.documentElement.style.setProperty('--color_primary',  localStorage.getItem('mainColorbyKadaiPortal'));
  document.getElementById('nav-drawer').insertAdjacentHTML('beforeend', '<div class="tools_tab_content" id="tools_moodleColor_content"><h4><br>メインテーマ色変更</h4><input id="tools_moodle_default"    type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_default"class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_default"> デフォルト  </label><input id="tools_moodle_black"      type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_black"  class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_black">   black       </label><input id="tools_moodle_gray"       type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_gray"   class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_gray">    gray        </label><input id="tools_moodle_silver"     type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_silver" class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_silver">  silver      </label> <input id="tools_moodle_blue"       type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_blue"   class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_blue">    blue        </label><input id="tools_moodle_navy"       type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_navy"   class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_navy">    navy        </label><input id="tools_moodle_teal"       type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_teal"   class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_teal">    teal        </label><input id="tools_moodle_green"      type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_green"  class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_green">   green       </label><input id="tools_moodle_lime"       type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_lime"   class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_lime">    lime            </label><input id="tools_moodle_aqua"       type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_aqua"   class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_aqua">    aqua            </label><input id="tools_moodle_yellow"     type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_yellow" class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_yellow">  yellow          </label><input id="tools_moodle_red"        type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_red"    class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_red">     red             </label><input id="tools_moodle_olive"      type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_olive"  class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_olive">    olive          </label><input id="tools_moodle_purple"     type="radio"    name="tools_moodle_color"><label id="tools_moodle_btn_purple" class="tools_tab_moodle hvr-shutter-out-horizontal tools_moodleColor_button"     for="tools_moodle_purple">   purple         </label><h5 id="tools_moodle_choiceColorCodeMessage">RGBカラーコードで指定する</h5><p>↓↓↓クリックして選択↓↓↓</p><input type="color" id="tools_moodle_choiceColorCodeInput"><style>.tools_tab_moodle {position: relative;display: block;width:50%;padding: 0.50rem 0.625rem;background-color: #fff;border: 1px solid rgba(0,0,0,.125);}input[name="tools_moodle_color"] {display: none;}#tools_moodle_btn_default{border-bottom: 8px solid #75ac2d;  /*下のラインの色*/}#tools_moodle_btn_default::before{background: #75ac2d;}input:checked + #tools_moodle_btn_default {background-color: #578021;color: #fff;}#tools_moodle_btn_black{border-bottom: 8px solid black;  /*下のラインの色*/}#tools_moodle_btn_black::before{background: black;}input:checked + #tools_moodle_btn_black {background-color: #000000;color: #fff;}#tools_moodle_btn_gray{border-bottom: 8px solid gray;  /*下のラインの色*/}#tools_moodle_btn_gray::before{background: gray;}input:checked + #tools_moodle_btn_gray {background-color: rgb(96, 95, 95);color: #fff;}#tools_moodle_btn_silver{border-bottom: 8px solid silver;  /*下のラインの色*/}#tools_moodle_btn_silver::before{background: silver;}input:checked + #tools_moodle_btn_silver {background-color: rgb(121, 121, 121);color: #fff;}#tools_moodle_btn_white{border-bottom: 8px solid white;  /*下のラインの色*/}#tools_moodle_btn_white::before{background: white;}input:checked + #tools_moodle_btn_white {background-color: rgb(245, 245, 245);color: #565656;}#tools_moodle_btn_blue{border-bottom: 8px solid blue;  /*下のラインの色*/}#tools_moodle_btn_blue::before{background: blue;}input:checked + #tools_moodle_btn_blue {background-color: rgb(0, 0, 173);color: #fff;}#tools_moodle_btn_navy{border-bottom: 8px solid navy;  /*下のラインの色*/}#tools_moodle_btn_navy::before{background: navy;}input:checked + #tools_moodle_btn_navy {background-color: rgb(0, 0, 96);color: #fff;}#tools_moodle_btn_teal{border-bottom: 8px solid teal;  /*下のラインの色*/}#tools_moodle_btn_teal::before{background: teal;}input:checked + #tools_moodle_btn_teal {background-color: rgb(0, 91, 91);color: #fff;}#tools_moodle_btn_green{border-bottom: 8px solid green;  /*下のラインの色*/}#tools_moodle_btn_green::before{background: green;}input:checked + #tools_moodle_btn_green {background-color: rgb(0, 110, 0);color: #fff;}#tools_moodle_btn_lime{border-bottom: 8px solid lime;  /*下のラインの色*/}#tools_moodle_btn_lime::before{background: lime;}input:checked + #tools_moodle_btn_lime {background-color: rgb(3, 180, 3);color: #fff;}#tools_moodle_btn_aqua{border-bottom: 8px solid aqua;  /*下のラインの色*/}#tools_moodle_btn_aqua::before{background: aqua;}input:checked + #tools_moodle_btn_aqua {background-color: rgb(0, 157, 157);color: #fff;}#tools_moodle_btn_yellow{border-bottom: 8px solid yellow;  /*下のラインの色*/}#tools_moodle_btn_yellow::before{background: yellow;color:#565656}input:checked + #tools_moodle_btn_yellow {background-color: rgb(168, 168, 0);color: #fff;}#tools_moodle_btn_red{border-bottom: 8px solid red;  /*下のラインの色*/}#tools_moodle_btn_red::before{background: red;}input:checked + #tools_moodle_btn_red {background-color: rgb(164, 0, 0);color: #fff;}#tools_moodle_btn_olive{border-bottom: 8px solid olive;  /*下のラインの色*/}#tools_moodle_btn_olive::before{background: olive;}input:checked + #tools_moodle_btn_olive {background-color: rgb(91, 91, 0);color: #fff;}#tools_moodle_btn_purple{border-bottom: 8px solid purple;  /*下のラインの色*/}#tools_moodle_btn_purple::before{background: purple;}input:checked + #tools_moodle_btn_purple {background-color: rgb(79, 0, 79);color: #fff;}/* Shutter Out Horizontal */.hvr-shutter-out-horizontal {display: inline-block;vertical-align: middle;-webkit-transform: perspective(1px) translateZ(0);transform: perspective(1px) translateZ(0);box-shadow: 0 0 1px rgba(0, 0, 0, 0);position: relative;background: #ffffff;-webkit-transition-property: color;transition-property: color;-webkit-transition-duration: 0.3s;transition-duration: 0.3s;}.hvr-shutter-out-horizontal:before {content: "";position: absolute;z-index: -1;top: 0;bottom: 0;left: 0;right: 0;background: #2098D1;-webkit-transform: scaleX(0);transform: scaleX(0);-webkit-transform-origin: 50%;transform-origin: 50%;-webkit-transition-property: transform;transition-property: transform;-webkit-transition-duration: 0.3s;transition-duration: 0.3s;-webkit-transition-timing-function: ease-out;transition-timing-function: ease-out;}.hvr-shutter-out-horizontal:hover, .hvr-shutter-out-horizontal:focus, .hvr-shutter-out-horizontal:active {color: white;}.hvr-shutter-out-horizontal:hover:before, .hvr-shutter-out-horizontal:focus:before, .hvr-shutter-out-horizontal:active:before {-webkit-transform: scaleX(1);transform: scaleX(1);}#tools_moodle_choiceColorCodeInput{width:80%;}</style></div>');  
  setTimeout(function(){
    document.getElementById("tools_moodle_default").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','#75ac2d');    localStorage.setItem('color','#75ac2d');    chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"#75ac2d"}, function(response) {});     });
    document.getElementById("tools_moodle_black").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','black');        localStorage.setItem('color','black');        chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"black"}, function(response) {});     });
    document.getElementById("tools_moodle_gray").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','gray');          localStorage.setItem('color','gray');          chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"gray"}, function(response) {});       });
    document.getElementById("tools_moodle_silver").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','silver');      localStorage.setItem('color','silver');      chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"silver"}, function(response) {});   });
    document.getElementById("tools_moodle_blue").addEventListener("click", function(){document.documentElement.style.setProperty('--color_primary','blue');         localStorage.setItem('color','blue');         chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"blue"}, function(response) {});     });
    document.getElementById("tools_moodle_navy").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','navy');          localStorage.setItem('color','navy');          chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"navy"}, function(response) {});        });
    document.getElementById("tools_moodle_teal").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','teal');          localStorage.setItem('color','teal');          chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"teal"}, function(response) {});         });
    document.getElementById("tools_moodle_green").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','green');        localStorage.setItem('color','green');        chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"green"}, function(response) {});     });
    document.getElementById("tools_moodle_lime").addEventListener("click", function(){document.documentElement.style.setProperty('--color_primary','lime');         localStorage.setItem('color','lime');         chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"lime"}, function(response) {});      });
    document.getElementById("tools_moodle_aqua").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','aqua');          localStorage.setItem('color','aqua');          chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"aqua"}, function(response) {});    });
    document.getElementById("tools_moodle_yellow").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','yellow');      localStorage.setItem('color','yellow');      chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"yellow"}, function(response) {});      });
    document.getElementById("tools_moodle_red").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','red');            localStorage.setItem('color','red');            chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"red"}, function(response) {});       });  
    document.getElementById("tools_moodle_olive").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','olive');        localStorage.setItem('color','olive');        chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"olive"}, function(response) {});      });
    document.getElementById("tools_moodle_purple").addEventListener("click",function(){document.documentElement.style.setProperty('--color_primary','purple');      localStorage.setItem('color','purple');      chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:"purple"}, function(response) {});       });
    document.getElementById("tools_moodle_choiceColorCodeInput").addEventListener("input",function(){
      let moodleColorCodeChoicebox=document.getElementById("tools_moodle_choiceColorCodeInput").value;
      document.documentElement.style.setProperty('--color_primary',moodleColorCodeChoicebox);  
      localStorage.setItem('color',moodleColorCodeChoicebox);
      chrome.runtime.sendMessage({greeting: "messageFromPopup!!",color:moodleColorCodeChoicebox}, function(response) {});});
  },1000)
  setTimeout(function(){
    document.getElementById('nav-drawer').insertAdjacentHTML('beforeend', '<nav class="list-group mt-1"><ul><li class="list-group-item list-group-item-action"><a href="https://twitter.com/KU_SETOKU">Twitter</a></li><li class="list-group-item list-group-item-action  "><a href="https://kadai-portal.mimimimineko.com/">拡張機能HP</a></li></ul></nav>'); 
  },1100);
};



//色設定に変更があった時用
chrome.runtime.sendMessage({greeting: "messageFromContentScripts!!"}, function(response) {
  document.documentElement.style.setProperty('--color_primary',  response.color);
  localStorage.setItem('mainColorbyKadaiPortal',response.color)
  console.log(response.color);
});

